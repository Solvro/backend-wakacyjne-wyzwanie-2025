## Zadanie 4 - Autoryzacja i walidatory

--------

#### Zadanie domowe

1. Dodaj endpoint do rejestracji użytkownika
    - Pamiętaj o tym aby zapisać hasło po hashowaniu.
    - Zastanów się jakie kody błędów powinny być zwracane? Np. 409 CONFLICT, gdy istnieje już użytkownik o podanym emailu.
2. Zastanów się, które endpointy powinny być dostępne publicznie (dla każdego), a które tylko dla osób zalogowanych i tych z odpowiednimi uprawnieniami  
   - Dodaj rolę koordynatora wycieczki. Tylko on (oraz administrator) powinnen mieć prawo zmiany informacji o wycieczce.
   - Podziel obecne endpointy na publiczne i prywatne dodając zabezpiecznia (guardy).
   - Zastanów się, które informacje powinny móc opuścić nasze API, a co powinno zostać jednak ukryte (sprawdź i zaaktualizuj swoje DTO pod tym względem).
3. Stwórz endpoint podobny do `PATCH /user` pokazanego na prezentacji. Zmień go, tak aby dany użytkownik mógł modyfikować jedynie swoje dane (tak jest obecnie)
oraz, aby użytkownik z prawami administratora mógł modyfikować dane każdego użytkownika. Nie twórz dwóch osobych endpointów.
4. Zmodyfikuj endpoint do logowania:
   - Dodaj obecny znacznik czasu do tokenu.
   - Dodaj zmienną środowiskową `EXPIRY_TIME_MS`, oznaczającą czas ważności tokenu w milisekundach
   - Przy sprawdzniu poprawności tokenu, sprawdź czy token jest jeszcze ważny, jeżeli nie jest, odeśli komunikat o tym.
5. Dodaj walidację do obecnych endpointów
   - Sprawdzaj poprawność parametrów wejściowych.
   - Dodaj walidację do DTO.
   - Stwórz jeden własny walidator, który ma sens. Np. data nie może być lub musi być z przyszłości.
6. (Tylko dla chętnych) Dodaj do swojej aplikacji CORS. Skonfiguruj tak, aby akceptował połączenia z localhost i portów od `5000` do `5599` włącznie.

---------

Materiały:

- Link do [nagrania prezentacji](TODO) z wykładu [TODO link]
- Przedstawiona podczas prezentacji wiedza o dobrych praktykach
- Slajdy z prezentacji
- To repozytorium
- https://docs.nestjs.com/security
- https://github.com/typestack/class-validator (walidatory używane przez Nest'a)
- (Dla chętnych do punktu 6: https://github.com/expressjs/cors#configuration-options)
